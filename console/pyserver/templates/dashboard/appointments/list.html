{% load static %} {% load svg %}
{% for communication in communications %}
  <div class="flc view-list__entry call-list__entry call-list__entry--{{ communication.status_verbose }}">
    
    <div class="widget-list__field widget-list__field--id">      
      {{ communication.id }}
    </div>

    <div class="widget-list__field widget-list__field--status-icon"
      aria-label="{{ communication.status_verbose|title }}"
      data-microtip-position="bottom"
      data-role="tooltip"      
    >
      <img class="meeting-status--icon" src="/static/images/status-{{ communication.status_verbose|title }}.svg">
    </div>
    
    <div class="df flc widget-list__field widget-list__field--date-time">
      {{ communication.modification_time|date:"m/d/Y H:i:s" }}
    </div>

    <div class="flc widget-list__field widget-list__field--name">
      <div class="fcol">
        <div class="widget-list__url-label">{{ communication.caller.profile.full_name|truncatechars:32 }}</div>
      </div>
    </div>
    <div class="flc widget-list__field widget-list__field--contact">
        {{ communication.caller.profile.email_or_phone|truncatechars:32 }}
    </div>
    <div class="flc widget-list__field widget-list__field--url">
      <div class="fcol">
        <a class="widget-list__url-label widget-list__label--link-url" href="{{ communication.link_url }}" target="_blank" >{{ communication.short_url }}</a>
      </div>
    </div>
    
    <div class="f1"></div>
    <div class="flc widget-list__field widget-list__field--mod-bar">
      {% if communication.status == 1 and communication.pending_sessions_count > 0 %}
      <form class="form--accept-appointment" data-id="{{ communication.id }}" action="{% url 'dashboard:change_appointment_status' appointment_id=communication.id status=6 %}" method="post">{% csrf_token %}
        <div class="fc df-f1 com__list-link list-link--accept" data-id="{{ communication.id }}" >Accept</div>
      </form>
      <form class="form--reject-appointment" data-id="{{ communication.id }}" action="{% url 'dashboard:change_appointment_status' appointment_id=communication.id status=5 %}" method="post">{% csrf_token %}
        <div class="fc df-f1 com__list-link list-link--reject" value="Reject" data-id="{{ communication.id }}">Reject</div>
      </form>
      {% else %}

      <a class="fc df-f1 widgets__list-link list-link--edit" href="{% url 'dashboard:appointment_edit' appointment_id=communication.id  %}"
          target="_self"
          aria-label="Edit"
          data-microtip-position="bottom"
          data-role="tooltip"
      >{% svg "edit" %}</a>      
      <a class="fc df-f1 widgets__list-link list-link--delete" href="{% url 'dashboard:appointment_delete' appointment_id=communication.id  %}" target="_self"
        aria-label="Delete"
        data-microtip-position="bottom"
        data-role="tooltip"                   
      >{% svg "delete" %}</a>
      {% endif %}
    </div>
  </div>
{% empty %}
  <div class="no-widgets fc">
    <p>No appointments.</p>
  </div>
{% endfor %}